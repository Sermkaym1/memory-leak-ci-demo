# üöÄ –£–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞

## üìã **–ß—Ç–æ –±—ã–ª–æ —É–ª—É—á—à–µ–Ω–æ:**

### ‚úÖ **1. –£–±—Ä–∞–ª–∏ –ª–∏—à–Ω–∏–µ sleep'—ã**

**–ë—ã–ª–æ:**
```python
# –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ 30 —Å–µ–∫—É–Ω–¥
print("‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–æ–≤ (30 —Å–µ–∫)...")
time.sleep(30)
```

**–°—Ç–∞–ª–æ:**
```python
# –£–º–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ HTTP
def wait_for_service_health(url: str, service_name: str, max_wait: int = 60):
    while time.time() - start_time < max_wait:
        try:
            response = requests.get(url, timeout=2)
            if response.status_code == 200:
                print(f"‚úÖ {service_name} –≥–æ—Ç–æ–≤ –∑–∞ {elapsed:.1f} —Å–µ–∫")
                return True
        except:
            pass
        time.sleep(2)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¢–µ—Å—Ç—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –∫–∞–∫ —Ç–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å—ã –≥–æ—Ç–æ–≤—ã (5-10 —Å–µ–∫ –≤–º–µ—Å—Ç–æ 30)

---

### ‚úÖ **2. –î–æ–±–∞–≤–∏–ª–∏ –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å –≤ —Ç–µ—Å—Ç—ã**

**–ë—ã–ª–æ:**
```
‚è±Ô∏è  1 –º–∏–Ω: RSS=67.8 MB
‚è±Ô∏è  2 –º–∏–Ω: RSS=89.4 MB
```

**–°—Ç–∞–ª–æ:**
```
üìä [ 10.0%] ‚è±Ô∏è  30—Å/300—Å üìà RSS:  45.2 MB üíæ VMS:  234.1 MB ‚è≥ –û—Å—Ç–∞–ª–æ—Å—å: 270—Å üìè –ò–∑–º–µ—Ä–µ–Ω–∏–π: 3
üìä [ 20.0%] ‚è±Ô∏è  60—Å/300—Å üìà RSS:  67.8 MB üíæ VMS:  251.3 MB ‚è≥ –û—Å—Ç–∞–ª–æ—Å—å: 240—Å üìè –ò–∑–º–µ—Ä–µ–Ω–∏–π: 6
üìä [ 30.0%] ‚è±Ô∏è  90—Å/300—Å üìà RSS:  89.4 MB üíæ VMS:  278.9 MB ‚è≥ –û—Å—Ç–∞–ª–æ—Å—å: 210—Å üìè –ò–∑–º–µ—Ä–µ–Ω–∏–π: 9
```

**–ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è:**
- üìä –ü—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è `[30.0%]`
- ‚è±Ô∏è –í—Ä–µ–º—è `90—Å/300—Å`  
- üìà RSS –ø–∞–º—è—Ç—å (—Ä–µ–∞–ª—å–Ω–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ)
- üíæ VMS –ø–∞–º—è—Ç—å (–≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è)
- ‚è≥ –û—Å—Ç–∞–ª–æ—Å—å –≤—Ä–µ–º–µ–Ω–∏
- üìè –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–º–µ—Ä–µ–Ω–∏–π

---

### ‚úÖ **3. –£–ª—É—á—à–∏–ª–∏ Makefile**

**–î–æ–±–∞–≤–∏–ª–∏:**
- –ü–æ–¥—Ä–æ–±–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è —á—Ç–æ –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å
- –ü—Ä–æ–≤–µ—Ä–∫–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ö—Ä–∞—Å–∏–≤—ã–π –≤—ã–≤–æ–¥ —Å —ç–º–æ–¥–∑–∏

**–ü—Ä–∏–º–µ—Ä:**
```bash
make test-quick  # –¢–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:

‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë           ‚ö° –ë–´–°–¢–†–´–ï –¢–ï–°–¢–´ –° –ù–ê–ë–õ–Æ–î–ê–ï–ú–û–°–¢–¨–Æ                ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

üìã –ß—Ç–æ –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å:
  1Ô∏è‚É£  –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–æ–≤ (–ë–ï–ó –¥–æ–ª–≥–∏—Ö –æ–∂–∏–¥–∞–Ω–∏–π)
  2Ô∏è‚É£  –¢–µ—Å—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –° —É—Ç–µ—á–∫–æ–π (5 –º–∏–Ω) —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–º
  3Ô∏è‚É£  –¢–µ—Å—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ë–ï–ó —É—Ç–µ—á–∫–∏ (5 –º–∏–Ω) —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–º
  4Ô∏è‚É£  –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏
```

---

### ‚úÖ **4. –û–±—ä—è—Å–Ω–∏–ª–∏ –∑–∞—á–µ–º PostgreSQL –∏ Redis**

–°–æ–∑–¥–∞–ª–∏ —Ñ–∞–π–ª `docs/WHY_POSTGRES_REDIS.md` —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º:

**PostgreSQL –Ω—É–∂–µ–Ω –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —É—Ç–µ—á–∫–∏ DB —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π:**
```python
# ‚ùå –ü–ª–æ—Ö–æ - —É—Ç–µ—á–∫–∞
conn = psycopg2.connect(...)
# –∑–∞–±—ã–ª–∏ conn.close()

# ‚úÖ –•–æ—Ä–æ—à–æ - connection pool
with conn_pool.getconn() as conn:
    # –∏—Å–ø–æ–ª—å–∑—É–µ–º
    pass  # –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –ø—É–ª
```

**Redis –Ω—É–∂–µ–Ω –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —É—Ç–µ—á–∫–∏ connection pool:**
```python
# ‚ùå –ü–ª–æ—Ö–æ - –∫–∞–∂–¥—ã–π —Ä–∞–∑ –Ω–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç
r = redis.Redis(...)  # —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π connection pool

# ‚úÖ –•–æ—Ä–æ—à–æ - singleton client
REDIS_CLIENT = redis.Redis(connection_pool=pool)  # –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º
```

---

## üöÄ **–ö–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ Linux:**

### **1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:**
```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
bash scripts/install.sh

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

### **2. –ó–∞–ø—É—Å–∫ —Å Docker:**
```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up -d

# –ë—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã (5 –º–∏–Ω) —Å –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å—é
make test-quick

# –ü–æ–ª–Ω—ã–µ —Ç–µ—Å—Ç—ã (10-15 –º–∏–Ω)
make test

# –û—Ç—á–µ—Ç
make report
```

### **3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ Docker:**
```bash
# –¢–µ—Å—Ç —É–ª—É—á—à–µ–Ω–∏–π (–Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å, –≥—Ä–∞—Ñ–∏–∫–∏)
python test_improvements.py
```

---

## üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç —É–ª—É—á—à–µ–Ω–∏–π:**

| –î–æ | –ü–æ—Å–ª–µ |
|----|----|
| ‚ùå –ñ–¥–µ–º 30 —Å–µ–∫ –≤—Å–µ–≥–¥–∞ | ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ–º –∫–∞–∫ —Ç–æ–ª—å–∫–æ –≥–æ—Ç–æ–≤–æ (5-10 —Å–µ–∫) |
| ‚ùå –ü—Ä–æ–≥—Ä–µ—Å—Å —Ä–∞–∑ –≤ –º–∏–Ω—É—Ç—É | ‚úÖ –ü–æ–¥—Ä–æ–±–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫ |
| ‚ùå –ù–µ—è—Å–Ω–æ —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç | ‚úÖ –í–∏–¥–∏–º % –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –ø–∞–º—è—Ç—å, –≤—Ä–µ–º—è |
| ‚ùå –ù–µ–ø–æ–Ω—è—Ç–Ω–æ –∑–∞—á–µ–º –ë–î | ‚úÖ –ß–µ—Ç–∫–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ |

**–ò—Ç–æ–≥:** –¢–µ—Å—Ç—ã —Å—Ç–∞–ª–∏ **–±—ã—Å—Ç—Ä–µ–µ –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è** –∏ **–ø–æ–Ω—è—Ç–Ω–µ–µ —Ä–∞–±–æ—Ç–∞—Ç—å**! üéâ